"0",""
"0","search_details <- search_details %>%"
"0","  clean_data() %>%"
"0","  rename(date_screened = date_screening_in_format_2020_05_22) %>%"
"0","  write_rds(here::here('data_clean', 'search_details.rds')) ## The title of the date screened column is to communicate among the review team how we need date formatted"
"0",""
"0","protect_columns_1 <- names(data_study_general) %in% 'doi' ## As the DoI's are links we want to preserve their formatting when running the cleaning script"
"0",""
"0","data_study_general <- data_study_general %>%"
"0","  rename('notes' = 11, date_published = `date_published_format(2020-05-12)`) %>%"
"0","  clean_data(protect = protect_columns_1) %>%"
"0","  mutate(study_id = 1:length(lead_author)) %>% ## We create a unique study ID to aid checking of the outputs later"
"0","  write_rds(here::here('data_clean', 'data_study_general.rds'))"
"0",""
"0","review_details <- data_study_general %>%"
"0","  select(lead_author, date_published, country, review_version, study_id) %>% ## The version of the review in which included studies were incorporated is noted"
"0","  write_rds(here::here('data_clean', 'review_details.rds'))"
"0",""
"0","table_1 <- table_1 %>%"
"0","  clean_data() %>%"
"0","  mutate(., lower_range = sub('\\_.*', '', .$range)) %>%"
"0","  mutate(., upper_range = sub('.*_', '',.$range,)) %>% ## We break apart the age range into an upper and lower level"
"0","  select(lead_author, sample_size, female_sex_percent, data_source, median_age, mean_age, iqr_lower, iqr_upper, standard_deviation, lower_range,"
"0","         upper_range, current_smoker, former_smoker, current_former_smoker, never_smoker, never_smoker_unknown, current_vaper, former_vaper,"
"0","         current_former_vaper, not_stated, missing, total) %>%"
"0","  filter(!is.na(lead_author)) %>%"
"0","  left_join(., review_details, by = 'lead_author') %>%"
"0","  write_rds(here::here('data_clean', 'table_1.rds'))"
"0",""
"0",""
"0","##For the following tables we're only interested in obtaining data for trials which report on the specific outcome of interest"
"0",""
"0","table_2 <-  table_2 %>%"
"0","  clean_data() %>%"
"0","  filter(data_on_testing == TRUE) %>%"
"0","  left_join(., review_details, by = 'lead_author') %>%"
"0","  write_rds(here::here('data_clean', 'table_2.rds'))"
"0",""
"0","table_3 <-  table_3 %>%"
"0","  clean_data() %>%"
"0","  filter(data_on_hospitalisation == TRUE) %>%"
"0","  left_join(., review_details, by = 'lead_author') %>%"
"0","  write_rds(here::here('data_clean', 'table_3.rds'))"
"0",""
"0","table_4 <-  table_4 %>%"
"0","  clean_data() %>%"
"0","  filter(data_disease_severity == TRUE) %>%"
"0","  left_join(., review_details, by = 'lead_author') %>%"
"0","  write_rds(here::here('data_clean', 'table_4.rds'))"
"0",""
"0","table_5 <- table_5 %>%"
"0","  clean_data() %>%"
"0","  filter(data_on_deaths == TRUE) %>%"
"0","  left_join(., review_details, by = 'lead_author') %>%"
"0","  write_rds(here::here('data_clean', 'table_5.rds'))"
"0",""
"0",""
"0","protect_columns_2 <- !names(table_6) %in% 'Author'"
"0",""
"0","table_6 <-  table_6 %>%"
"0","  clean_data(protect = protect_columns_2) %>%"
"0","  left_join(., table_1 %>%"
"0","              select(lead_author,"
"0","                     not_stated,"
"0","                     missing,"
"0","                     total) %>%"
"0","              rename('author' = lead_author),"
"0","            by = 'author') %>%"
"0","  mutate(missingness = rowSums(.[17:18], na.rm = T),"
"0","         missingness_percentage = (missingness/total)*100) %>% ## Later we want to assess the amount of missingness for each study as it would impact the inclusion of a study into the relevant meta-analyses"
"0","  select(-c(not_stated, missing, total, missingness)) %>%"
"0","  write_rds(here::here('data_clean', 'table_6.rds'))"
"0",""
"0","a <- data_study_general %>%"
"0","  select(lead_author, date_published, source, study_id) %>%"
"0","  rename('Lead Author' = lead_author,"
"0","         'Date Published' = date_published,"
"0","         'Publication Source' = source,"
"0","         'Study ID' = study_id)"
"0",""
"0","a$`Lead Author` <- to_upper_camel_case(a$`Lead Author`, sep_out = "", "")"
"0","a$`Publication Source` <- to_title_case(a$`Publication Source`)"
"0","a$`Publication Source` <- if_else(str_length(a$`Publication Source`) < 5,"
"0","                                  toupper(a$`Publication Source`),"
"0","                                  to_title_case(a$`Publication Source`))"
"0",""
"0","table_1$median_age"
"1","  [1]"
"1"," 47.0"
"1"," 49.0"
"1","   NA"
"1"," 46.0"
"1"," 62.0"
"1"," 56.0"
"1"," 54.0"
"1","   NA"
"1"," 47.0"
"1"," 38.0"
"1"," 49.0"
"1","   NA"
"1"," 59.0"
"1"," 39.0"
"1"," 69.0"
"1","   NA"
"1"," 45.0"
"1"," 66.0"
"1","   NA"
"1"," 41.0"
"1","   NA"
"1"," 52.0"
"1","   NA"
"1","   NA"
"1"," 44.0"
"1"," 43.0"
"1"," 46.0"
"1"," 60.0"
"1"," 63.0"
"1"," 46.0"
"1"," 63.0"
"1"," 37.0"
"1","   NA"
"1"," 55.0"
"1","
"
"1"," [35]"
"1"," 68.0"
"1"," 69.0"
"1"," 46.0"
"1"," 55.0"
"1","   NA"
"1"," 71.0"
"1","   NA"
"1","   NA"
"1"," 71.0"
"1","   NA"
"1","   NA"
"1","   NA"
"1","   NA"
"1"," 73.0"
"1"," 71.0"
"1","   NA"
"1","   NA"
"1"," 77.0"
"1","   NA"
"1","   NA"
"1"," 61.0"
"1"," 61.0"
"1"," 63.0"
"1","   NA"
"1"," 58.0"
"1"," 57.0"
"1"," 62.2"
"1"," 53.0"
"1"," 52.0"
"1"," 56.6"
"1"," 41.0"
"1","   NA"
"1"," 35.0"
"1"," 56.2"
"1","
"
"1"," [69]"
"1"," 70.0"
"1"," 72.0"
"1"," 58.0"
"1","   NA"
"1","   NA"
"1"," 56.0"
"1"," 70.0"
"1"," 44.9"
"1"," 55.5"
"1"," 49.0"
"1","   NA"
"1"," 55.0"
"1"," 59.0"
"1"," 64.0"
"1"," 64.0"
"1"," 62.0"
"1","   NA"
"1"," 62.0"
"1","   NA"
"1","   NA"
"1"," 71.0"
"1"," 64.0"
"1"," 61.0"
"1"," 62.0"
"1","   NA"
"1","   NA"
"1"," 67.0"
"1","   NA"
"1"," 56.0"
"1","   NA"
"1","   NA"
"1","   NA"
"1"," 62.0"
"1","   NA"
"1","
"
"1","[103]"
"1"," 52.0"
"1","   NA"
"1","   NA"
"1","   NA"
"1"," 63.0"
"1"," 72.9"
"1"," 40.0"
"1"," 66.0"
"1","   NA"
"1","   NA"
"1"," 52.0"
"1"," 67.0"
"1","   NA"
"1","   NA"
"1"," 64.0"
"1"," 29.0"
"1","   NA"
"1"," 46.0"
"1"," 34.0"
"1"," 61.0"
"1","   NA"
"1","   NA"
"1","   NA"
"1","   NA"
"1","   NA"
"1","   NA"
"1"," 70.5"
"1"," 68.0"
"1","   NA"
"1","   NA"
"1","   NA"
"1","   NA"
"1","
"
